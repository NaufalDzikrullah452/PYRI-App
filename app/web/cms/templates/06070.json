{"content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  const { data, event } = req.body;\n  let res = \"Failure\";\n  let isTrue = false;\n  if (event === \"Login\") {\n    const username = await db.users.findFirst({\n      where: {\n        user_name: data.username,\n      },\n    });\n    console.log(\"username\");\n    console.log(username);\n    if (!username) {\n      res = \"Wrong Username!\";\n    } else {\n      const password = await db.users.findFirst({\n        where: {\n          user_name: data.username,\n          user_password: data.password,\n        },\n      });\n      console.log(\"password\");\n      console.log(password);\n      if (!password) {\n        res = \"Wrong Password\";\n      } else if (password.user_level) {\n        res = \"Login Success\";\n        isTrue = password.user_level;\n        user.user = {\n          role: user.user.role,\n          user: user.user.user || \"\",\n          roleAdmin: \"admin\",\n        };\n      } else {\n        res = \"Wrong Username/password!\";\n      }\n    }\n  }\n  if (event === \"Logout\") {\n    res = \"Logout Success\";\n    isTrue = true;\n    user.user = {\n      role: user.user.role,\n      user: user.user.user || \"\",\n      roleAdmin: \"guest\",\n    };\n  }\n  reply.send({\n    res: res,\n    value: isTrue,\n  })\n}","figma":{}},"title":"api-admin","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"54643","slug":"/api/admin","site":"*","id":"06070"}